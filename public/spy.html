<!DOCTYPE html>
<html>
    <head>
        <title>Controller Page</title>

        <Script src = "https://aframe.io/releases/1.0.3/aframe.min.js"></script>
        <script src="https://unpkg.com/aframe-environment-component@1.1.0/dist/aframe-environment-component.min.js"></script>
        <script src="https://unpkg.com/aframe-look-at-component@0.8.x/dist/aframe-look-at-component.min.js"></script> 
        <script src="/socket.io/socket.io.js"></script>
    </head>
    <body>
        <a-scene shadow="type: pcfsoft">
            <a-assets timeout="10000">
                <a-asset-item id="monster_model"   response-type="arraybuffer" src="models/monster.glb"></a-asset-item>
                <a-asset-item id="facility_model"   response-type="arraybuffer" src="models/facility.glb"></a-asset-item>
            </a-assets>

            <a-entity environment = "preset:starry;"></a-entity> 

            <!-- Camera -->
            <a-entity id = cam_rig, position = "0 0.5 0">
                <a-camera class = "cam" look-controls position = "0 1.3 0" far="1000000000">  
                    <a-entity light="type:point; intensity:0.9; castShadow: true; shadowCameraNear: 0.1; shadowCameraLeft: -1; shadowCameraBottom: -1;shadowCameraRight: 1;shadowCameraTop: 1; shadowCameraFov: 90.11; shadowRadius: 4.640; distance:10;" position="0 0 0.9" ></a-entity>
                    <a-entity   cursor="rayOrigin:mouse;"
                            raycaster="far:30; interval:100; objects:.clickable;">
                        
                    </a-entity>
                    <a-entity   class="targetDir"
                                position="0 0 -1">
                    </a-entity>       

                </a-camera>        
            </a-entity>

            <!-- Poor little monster-->
            <a-entity   id = "monster_boi"
                position = "-1.3 1 3.2"
                rotation = "0 0 0"
                scale = "0.5 0.5 0.5"
                gltf-model = "#monster_model">
            </a-entity>

            <!-- The Facility shell, most dynamic stuff will be separate -->
            <a-entity   id = "facility_boi"
                position = "0 1.5 0"
                rotation = "0 0 0"
                scale = "1 1 1"
                shadow="cast: true; receive: true;"
                gltf-model = "#facility_model">
            </a-entity>

            <!-- Laser Beam -->
            <a-entity id = "laser_beam"
                    position = "13 1.5 -16"
                    rotation = "0 0 0"
                    scale = "9 0.06 0.06"
                    animation="property: rotation; from: 0 0 -9; to: 0 0 9; loop: true; dur: 400; easing: easeInOutCubic; dir: alternate;">
                <a-entity   id = "laser_beam"
                    position = "-0.5 0 0"
                    rotation = "0 0 0"
                    scale = "1 1 1"
                    geometry="primitive: box; width: 1; height: 1; depth: 1;"
                    material="color: red">
                </a-entity>
            </a-entity>

            <!-- Laser Beam 2 -->
            <a-entity id = "laser_beam"
                    position = "5 1.7 -15"
                    rotation = "0 0 0"
                    scale = "9 0.06 0.06"
                    animation="property: rotation; from: 0 180 -9; to: 0 180 9; loop: true; dur: 300; easing: easeInOutCubic; dir: alternate;">
                <a-entity   id = "laser_beam"
                    position = "-0.5 0 0"
                    rotation = "0 0 0"
                    scale = "1 1 1"
                    geometry="primitive: box; width: 1; height: 1; depth: 1;"
                    material="color: red">
                </a-entity>
            </a-entity>

            <!-- Laser Beam 3 -->
            <a-entity id = "laser_beam"
                    position = "5 1.2 -14"
                    rotation = "0 0 0"
                    scale = "9 0.06 0.06"
                    animation="property: rotation; from: 0 180 -9; to: 0 180 9; loop: true; dur: 500; easing: easeInOutCubic; dir: alternate;">
                <a-entity   id = "laser_beam"
                    position = "-0.5 0 0"
                    rotation = "0 0 0"
                    scale = "1 1 1"
                    geometry="primitive: box; width: 1; height: 1; depth: 1;"
                    material="color: red">
                </a-entity>
            </a-entity>

        </a-scene>

        <h1>SPY</h1>
        
        <script>
            let socket = io();
            socket.on('connect', function(){
                console.log("I am connected - " + socket.id);
            });

            document.querySelector('').addEventListener('click',function(){
                console.log('Red button clicked');
                socket.emit('red_event');
            });
        </script>
    </body>
</html>